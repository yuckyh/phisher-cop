<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="icon"
      href="{{ url_for('static', filename='logo.png') }}"
      type="image/png"
    />
    <title>Phisher Cop</title>

    <!-- Link to the external CSS file -->
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='styles.css') }}"
    />

    <!-- Links for Bootstrap -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
      crossorigin="anonymous"
    ></script>
  </head>

  <body class="background dark-mode">
    <!-- Main container for the app -->
    <div class="main-container">
      <!-- Header and Logo -->
      <div class="header-logo-container">
        <!-- PLACEHOLDER IMAGE FOR LOGO!! -->
        <img
          src="/static/logo.png"
          alt="Phisher-Cop-Logo"
          class="logo-image"
          height="256"
        />
      </div>

      <!-- Title -->
      <h1 class="app-title">Email Phishing Detector</h1>

      <!-- Subtitle -->
      <p class="app-subtitle">
        Paste the full content of an email below to check if it's a phishing
        attempt.
      </p>

      <!-- The main form -->
      <!-- sends data via POST request to server -->
      <form method="POST" action="/" class="form-container" id="phishingForm">
        <div>
          <label class="form-label"
            >From <span class="required-asterisk">*</span>
            <input
              type="email"
              name="sender"
              class="form-input dark-input"
              placeholder="e.g., notascam@gmail.com"
              required
          /></label>
        </div>
        <div>
          <label class="form-label"
            >CC
            <input
              type="text"
              name="cc"
              class="form-input dark-input"
              placeholder="e.g., cc@example.com, dd@example.com"
          /></label>
        </div>
        <div>
          <label class="form-label"
            >Subject <span class="required-asterisk">*</span>
            <input
              type="text"
              name="subject"
              class="form-input dark-input"
              placeholder="e.g., Urgent Action Required: Your Account Has Been Locked"
              required
          /></label>
        </div>
        <div>
          <label class="form-label"
            >Email Body <span class="required-asterisk">*</span>
            <textarea
              name="payload"
              rows="10"
              class="form-input dark-input"
              placeholder="Paste the full email text here..."
              required
            ></textarea>
          </label>
        </div>

        <!-- Submit Button -->
        <button type="submit" class="submit-button dark-button">
          Check for Phishing
        </button>

        <!-- Display validation errors if any -->
        {% if errors %}
        <div class="alert alert-danger mt-3">
          <ul class="mb-0">
            {% for error in errors %}
            <li>{{ error }}</li>
            {% endfor %}
          </ul>
        </div>
        {% endif %}

        <!-- jinja template that only renders if result variable exists (i.e != None) -->
        {% if result is defined %} {% set status_text = 'Phishing' if result >=
        0.5 else 'Safe' %}
        <!-- Result box -->
        <div
          class="result-box {% if result >= 0.5 %}result-phishing{% else %}result-not-phishing{% endif %}"
        >
          <!-- Display the calculated status text prominently -->
          <p class="text-xl font-bold mb-2">Verdict: {{ status_text }}</p>

          <!-- Display the numerical score for detail -->
          <p class="text-sm">Score: {{ "%0.2f" | format(result) }}%</p>
        </div>
        {% endif %}
      </form>
    </div>
  </body>
</html>
